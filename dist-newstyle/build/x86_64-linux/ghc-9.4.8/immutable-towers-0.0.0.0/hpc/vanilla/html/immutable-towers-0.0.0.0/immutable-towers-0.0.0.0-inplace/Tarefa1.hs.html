<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
span.lineno { color: white; background: #aaaaaa; border-right: solid white 12px }
span.nottickedoff { background: yellow}
span.istickedoff { background: white }
span.tickonlyfalse { margin: -1px; border: 1px solid #f20913; background: #f20913 }
span.tickonlytrue  { margin: -1px; border: 1px solid #60de51; background: #60de51 }
span.funcount { font-size: small; color: orange; z-index: 2; position: absolute; right: 20 }
span.decl { font-weight: bold }
span.spaces    { background: white }
</style>
</head>
<body>
<pre>
<span class="decl"><span class="nottickedoff">never executed</span> <span class="tickonlytrue">always true</span> <span class="tickonlyfalse">always false</span></span>
</pre>
<pre>
<span class="lineno">    1 </span>{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}
<span class="lineno">    2 </span>{-# HLINT ignore &quot;Use all&quot; #-}
<span class="lineno">    3 </span>{-# HLINT ignore &quot;Use map once&quot; #-}
<span class="lineno">    4 </span>{-# HLINT ignore &quot;Use foldr&quot; #-}
<span class="lineno">    5 </span>{-# HLINT ignore &quot;Use any&quot; #-}
<span class="lineno">    6 </span>{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}
<span class="lineno">    7 </span>{-# OPTIONS_GHC -Wno-incomplete-patterns #-}
<span class="lineno">    8 </span>{-# OPTIONS_GHC -Wno-name-shadowing #-}
<span class="lineno">    9 </span>{-|
<span class="lineno">   10 </span>Module      : Tarefa1
<span class="lineno">   11 </span>Description : Invariantes do Jogo
<span class="lineno">   12 </span>Copyright   : Bruno Miguel Silva Magalhães &lt;a110274@alunos.uminho.pt&gt;
<span class="lineno">   13 </span>              João Luís Dias da Costa Oliveira &lt;a81116@alunos.uminho.pt&gt;
<span class="lineno">   14 </span>
<span class="lineno">   15 </span>Módulo para a realização da Tarefa 1 de LI1 em 2024/25.
<span class="lineno">   16 </span>-}
<span class="lineno">   17 </span>
<span class="lineno">   18 </span>module Tarefa1 where
<span class="lineno">   19 </span>
<span class="lineno">   20 </span>import LI12425
<span class="lineno">   21 </span>
<span class="lineno">   22 </span>
<span class="lineno">   23 </span>
<span class="lineno">   24 </span>
<span class="lineno">   25 </span>
<span class="lineno">   26 </span>-- | A função 'validaJogo' verifica se um dado jogo é ou não válido baseando-se numa série de condições verificadas por outras funções.
<span class="lineno">   27 </span>--
<span class="lineno">   28 </span>-- == Exemplos
<span class="lineno">   29 </span>--
<span class="lineno">   30 </span>-- &gt;&gt;&gt; validaJogo (Jogo (Base 100 (0,0) 100) [Portal (1,0) [Onda [Inimigo (1,0) Norte 100 1 5 5 [] [] 100 1] 5 1 (-5)]] [] mapa01 [] [] 1 (0,0) 0 (False,5,[]))
<span class="lineno">   31 </span>-- True
<span class="lineno">   32 </span>--
<span class="lineno">   33 </span>-- &gt;&gt;&gt; validaJogo (Jogo (Base 100 (0,0) 100) [Portal (3,0) [Onda [Inimigo (1,0) Norte 100 1 5 5 [] [] 100 1] 5 1 (-5)]] [] mapa01 [] [] 1 (0,0) 0 (False,5,[]))
<span class="lineno">   34 </span>-- False
<span class="lineno">   35 </span>
<span class="lineno">   36 </span>validaJogo :: 
<span class="lineno">   37 </span> -- | Jogo a validar.
<span class="lineno">   38 </span> Jogo -&gt;
<span class="lineno">   39 </span> -- | Resultado na forma 'True' caso o jogo é válido ou 'False' caso contrário.
<span class="lineno">   40 </span> Bool
<span class="lineno">   41 </span><span class="decl"><span class="istickedoff">validaJogo jogo = verifExistPortais portais &amp;&amp;</span>
<span class="lineno">   42 </span><span class="spaces">                  </span><span class="istickedoff">verifPortaisSobreTerra posicoesPortais mapa &amp;&amp;</span>
<span class="lineno">   43 </span><span class="spaces">                  </span><span class="istickedoff">verifConexaoBasePortais posBase posicoesPortais (filtraPosicoesTerra mapa (<span class="nottickedoff">0</span>,0)) &amp;&amp;</span>
<span class="lineno">   44 </span><span class="spaces">                  </span><span class="istickedoff">verifSobreposPortaisTorresBase posicoesPortais posicoesTorres posBase &amp;&amp;</span>
<span class="lineno">   45 </span><span class="spaces">                  </span><span class="istickedoff">and (map verifOndasAtivasPorPortal portais) &amp;&amp;</span>
<span class="lineno">   46 </span><span class="spaces">                  </span><span class="istickedoff">and (map verifInimigosInativos portais) &amp;&amp;</span>
<span class="lineno">   47 </span><span class="spaces">                  </span><span class="istickedoff">todosInimigosSobreTerra (map <span class="nottickedoff">posicaoInimigo</span> inimigosAtivos) <span class="nottickedoff">(filtraPosicoesTerra mapa (0,0))</span> &amp;&amp;</span>
<span class="lineno">   48 </span><span class="spaces">                  </span><span class="istickedoff">inimigosSobreposTorres inimigosAtivos <span class="nottickedoff">torres</span> &amp;&amp;</span>
<span class="lineno">   49 </span><span class="spaces">                  </span><span class="istickedoff">velocidadeInimigosNaoNegativa inimigosAtivos &amp;&amp;</span>
<span class="lineno">   50 </span><span class="spaces">                  </span><span class="istickedoff">and (map <span class="nottickedoff">verifProjeteisNormalizados</span> (map <span class="nottickedoff">projeteisInimigo</span> inimigosAtivos)) &amp;&amp;</span>
<span class="lineno">   51 </span><span class="spaces">                  </span><span class="istickedoff">verifTorresSobreRelva torres <span class="nottickedoff">mapa</span> &amp;&amp;</span>
<span class="lineno">   52 </span><span class="spaces">                  </span><span class="istickedoff">verifAlcanceTorres torres &amp;&amp;</span>
<span class="lineno">   53 </span><span class="spaces">                  </span><span class="istickedoff">verifRajadaTorres torres &amp;&amp;</span>
<span class="lineno">   54 </span><span class="spaces">                  </span><span class="istickedoff">verifCicloTorres torres &amp;&amp;</span>
<span class="lineno">   55 </span><span class="spaces">                  </span><span class="istickedoff">verifSobreposTorres torres &amp;&amp;</span>
<span class="lineno">   56 </span><span class="spaces">                  </span><span class="istickedoff">verifBaseSobreTerra base mapa &amp;&amp;</span>
<span class="lineno">   57 </span><span class="spaces">                  </span><span class="istickedoff">verifCreditosBase base &amp;&amp;</span>
<span class="lineno">   58 </span><span class="spaces">                  </span><span class="istickedoff">verifSobreposBaseTorresPortais posBase posicoesTorres posicoesPortais</span>
<span class="lineno">   59 </span><span class="spaces">                    </span><span class="istickedoff">where mapa = mapaJogo jogo</span>
<span class="lineno">   60 </span><span class="spaces">                          </span><span class="istickedoff">base = baseJogo jogo</span>
<span class="lineno">   61 </span><span class="spaces">                          </span><span class="istickedoff">posBase = posicaoBase base</span>
<span class="lineno">   62 </span><span class="spaces">                          </span><span class="istickedoff">portais = portaisJogo jogo</span>
<span class="lineno">   63 </span><span class="spaces">                          </span><span class="istickedoff">posicoesPortais = map posicaoPortal portais</span>
<span class="lineno">   64 </span><span class="spaces">                          </span><span class="istickedoff">torres = torresJogo jogo</span>
<span class="lineno">   65 </span><span class="spaces">                          </span><span class="istickedoff">posicoesTorres = map <span class="nottickedoff">posicaoTorre</span> torres</span>
<span class="lineno">   66 </span><span class="spaces">                          </span><span class="istickedoff">inimigosAtivos = inimigosJogo jogo</span></span>
<span class="lineno">   67 </span>
<span class="lineno">   68 </span>-- | 'mapa01' é um exemplo de um mapa.
<span class="lineno">   69 </span>
<span class="lineno">   70 </span>mapa01 :: Mapa
<span class="lineno">   71 </span><span class="decl"><span class="istickedoff">mapa01 = [[t, t, r, a, t, a],</span>
<span class="lineno">   72 </span><span class="spaces">          </span><span class="istickedoff">[r, t, r, a, t, r],</span>
<span class="lineno">   73 </span><span class="spaces">          </span><span class="istickedoff">[r, t, r, a, a, t],</span>
<span class="lineno">   74 </span><span class="spaces">          </span><span class="istickedoff">[r, t, t, a, r, t],</span>
<span class="lineno">   75 </span><span class="spaces">          </span><span class="istickedoff">[r, t, t, t, t, t],</span>
<span class="lineno">   76 </span><span class="spaces">          </span><span class="istickedoff">[a, a, a, a, r, r]]</span>
<span class="lineno">   77 </span><span class="spaces">            </span><span class="istickedoff">where t = Terra</span>
<span class="lineno">   78 </span><span class="spaces">                  </span><span class="istickedoff">r = Relva</span>
<span class="lineno">   79 </span><span class="spaces">                  </span><span class="istickedoff">a = Agua</span></span>
<span class="lineno">   80 </span>
<span class="lineno">   81 </span>
<span class="lineno">   82 </span>
<span class="lineno">   83 </span>
<span class="lineno">   84 </span>
<span class="lineno">   85 </span>-- {- Funções auxiliares -} --
<span class="lineno">   86 </span>
<span class="lineno">   87 </span>-- | A função 'dist' determina a distância entre dois pontos de um plano.
<span class="lineno">   88 </span>--
<span class="lineno">   89 </span>-- == Exemplos
<span class="lineno">   90 </span>--
<span class="lineno">   91 </span>-- &gt;&gt;&gt; dist (0,0) (4,3)
<span class="lineno">   92 </span>-- 5
<span class="lineno">   93 </span>--
<span class="lineno">   94 </span>-- &gt;&gt;&gt; dist (2,2) (2,3)
<span class="lineno">   95 </span>-- 1
<span class="lineno">   96 </span>
<span class="lineno">   97 </span>dist :: 
<span class="lineno">   98 </span> -- | Posição do primeiro ponto.
<span class="lineno">   99 </span> Posicao -&gt; 
<span class="lineno">  100 </span> -- | Posição do segundo ponto.
<span class="lineno">  101 </span> Posicao -&gt;
<span class="lineno">  102 </span> -- | Distância entre os dois pontos.
<span class="lineno">  103 </span> Float
<span class="lineno">  104 </span><span class="decl"><span class="istickedoff">dist (x1,y1) (x2,y2) = sqrt ((x1 - x2) ** 2 + (y1 - y2) ** 2)</span></span>
<span class="lineno">  105 </span>
<span class="lineno">  106 </span>-- | A função 'encontraPontosAdjacentes' filtra, de uma lista de pontos, apenas aqueles que se encontram adjacentes (não diagonalmente) a um outro ponto de um plano.
<span class="lineno">  107 </span>--
<span class="lineno">  108 </span>-- == Exemplos
<span class="lineno">  109 </span>--
<span class="lineno">  110 </span>-- &gt;&gt;&gt; encontraPontosAdjacentes (4,4) [(5,5),(3,5),(3,3)]
<span class="lineno">  111 </span>-- []
<span class="lineno">  112 </span>--
<span class="lineno">  113 </span>-- &gt;&gt;&gt; encontraPontosAdjacentes (2,3) [(3,3),(3,4),(3,5)]
<span class="lineno">  114 </span>-- [(3,3)]
<span class="lineno">  115 </span>--
<span class="lineno">  116 </span>-- &gt;&gt;&gt; encontraPontosAdjacentes (2,2) [(2,3),(2,1),(1,2)]
<span class="lineno">  117 </span>-- [(2,3),(2,1),(1,2)]
<span class="lineno">  118 </span>
<span class="lineno">  119 </span>encontraPontosAdjacentes :: 
<span class="lineno">  120 </span> -- | Ponto de foco.
<span class="lineno">  121 </span> Posicao -&gt; 
<span class="lineno">  122 </span> -- | Lista de pontos.
<span class="lineno">  123 </span> [Posicao] -&gt; 
<span class="lineno">  124 </span> -- | Pontos (não diagonalmente) adjacentes ao ponto de foco.
<span class="lineno">  125 </span> [Posicao]
<span class="lineno">  126 </span><span class="decl"><span class="istickedoff">encontraPontosAdjacentes _ [] = []</span>
<span class="lineno">  127 </span><span class="spaces"></span><span class="istickedoff">encontraPontosAdjacentes p (h:t)</span>
<span class="lineno">  128 </span><span class="spaces">    </span><span class="istickedoff">| dist p h == 1 = h : encontraPontosAdjacentes p t</span>
<span class="lineno">  129 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = encontraPontosAdjacentes p t</span></span>
<span class="lineno">  130 </span>
<span class="lineno">  131 </span>-- | A função 'filtraPosicoesTerra' determina as coordenadas de pontos correnpondentes apenas ao terreno de 'Terra' de um mapa.
<span class="lineno">  132 </span>--
<span class="lineno">  133 </span>-- == Exemplo
<span class="lineno">  134 </span>--
<span class="lineno">  135 </span>-- &gt;&gt;&gt; filtraPosicoesTerra mapa01 (0,0)
<span class="lineno">  136 </span>-- [(0.0,0.0),(1.0,0.0),(4.0,0.0),(1.0,1.0),(4.0,1.0),(1.0,2.0),(5.0,2.0),(1.0,3.0),(2.0,3.0),(5.0,3.0),(1.0,4.0),(2.0,4.0),(3.0,4.0),(4.0,4.0),(5.0,4.0)]
<span class="lineno">  137 </span>
<span class="lineno">  138 </span>filtraPosicoesTerra :: 
<span class="lineno">  139 </span> -- | Mapa do jogo.
<span class="lineno">  140 </span> Mapa -&gt;
<span class="lineno">  141 </span> -- | Posição do ponto na matriz (deve ser (0,0) inicialmente para determinar corretamente as coordenadas).
<span class="lineno">  142 </span> Posicao -&gt;
<span class="lineno">  143 </span> -- | Posições correpondentes ao terreno de 'Terra'.
<span class="lineno">  144 </span> [Posicao]
<span class="lineno">  145 </span><span class="decl"><span class="istickedoff">filtraPosicoesTerra [] _ = []</span>
<span class="lineno">  146 </span><span class="spaces"></span><span class="istickedoff">filtraPosicoesTerra (l:ls) (x,y) = filtraPosicoesTerraAux l (0,y) ++ filtraPosicoesTerra ls (<span class="nottickedoff">x</span>,y + 1)</span>
<span class="lineno">  147 </span><span class="spaces">    </span><span class="istickedoff">where filtraPosicoesTerraAux [] _ = []</span>
<span class="lineno">  148 </span><span class="spaces">          </span><span class="istickedoff">filtraPosicoesTerraAux (c:cs) (a,b)</span>
<span class="lineno">  149 </span><span class="spaces">            </span><span class="istickedoff">| c == Terra = (a,b) : filtraPosicoesTerraAux cs (a + 1,b)</span>
<span class="lineno">  150 </span><span class="spaces">            </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = filtraPosicoesTerraAux cs (a + 1,b)</span></span>
<span class="lineno">  151 </span>
<span class="lineno">  152 </span>-- | A função 'filtraPosicoesRelva' determina as coordenadas de pontos correnpondentes apenas ao terreno de 'Relva' de um mapa.
<span class="lineno">  153 </span>--
<span class="lineno">  154 </span>-- == Exemplo
<span class="lineno">  155 </span>--
<span class="lineno">  156 </span>-- &gt;&gt;&gt; filtraPosicoesRelva mapa01 (0,0)
<span class="lineno">  157 </span>-- [(2.0,0.0),(0.0,1.0),(2.0,1.0),(5.0,1.0),(0.0,2.0),(2.0,2.0),(0.0,3.0),(4.0,3.0),(0.0,4.0),(4.0,5.0),(5.0,5.0)]
<span class="lineno">  158 </span>
<span class="lineno">  159 </span>filtraPosicoesRelva :: 
<span class="lineno">  160 </span> -- | Mapa do jogo.
<span class="lineno">  161 </span> Mapa -&gt;
<span class="lineno">  162 </span> -- | Posição do ponto na matriz (deve ser (0,0) inicialmente para determinar corretamente as coordenadas).
<span class="lineno">  163 </span> Posicao -&gt;
<span class="lineno">  164 </span> -- | Posições correpondentes ao terreno de 'Relva'.
<span class="lineno">  165 </span> [Posicao]
<span class="lineno">  166 </span><span class="decl"><span class="istickedoff">filtraPosicoesRelva [] _ = []</span>
<span class="lineno">  167 </span><span class="spaces"></span><span class="istickedoff">filtraPosicoesRelva (l:ls) (x,y) = filtraPosicoesRelvaAux l (0,y) ++ filtraPosicoesRelva ls (<span class="nottickedoff">x</span>,y + 1)</span>
<span class="lineno">  168 </span><span class="spaces">    </span><span class="istickedoff">where filtraPosicoesRelvaAux [] _ = []</span>
<span class="lineno">  169 </span><span class="spaces">          </span><span class="istickedoff">filtraPosicoesRelvaAux (c:cs) (a,b)</span>
<span class="lineno">  170 </span><span class="spaces">            </span><span class="istickedoff">| c == Relva = (a,b) : filtraPosicoesRelvaAux cs (a + 1,b)</span>
<span class="lineno">  171 </span><span class="spaces">            </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = filtraPosicoesRelvaAux cs (a + 1,b)</span></span>
<span class="lineno">  172 </span>
<span class="lineno">  173 </span>-- | A função 'removeElemento' remove as ocorrências de um elemento específico de uma lista.
<span class="lineno">  174 </span>--
<span class="lineno">  175 </span>-- == Exemplos
<span class="lineno">  176 </span>--
<span class="lineno">  177 </span>-- &gt;&gt;&gt; removeElemento 3 [1,2,3,4,5]
<span class="lineno">  178 </span>-- [1,2,4,5]
<span class="lineno">  179 </span>--
<span class="lineno">  180 </span>-- &gt;&gt;&gt; removeElemento 6 [1,2,3,4,5]
<span class="lineno">  181 </span>-- [1,2,3,4,5]
<span class="lineno">  182 </span>
<span class="lineno">  183 </span>removeElemento :: Eq a =&gt; 
<span class="lineno">  184 </span> -- | Elemento a remover.
<span class="lineno">  185 </span> a -&gt; 
<span class="lineno">  186 </span> -- | Lista inicial.
<span class="lineno">  187 </span> [a] -&gt;
<span class="lineno">  188 </span> -- | Lista resultante.
<span class="lineno">  189 </span> [a]
<span class="lineno">  190 </span><span class="decl"><span class="istickedoff">removeElemento e = filter (/= e)</span></span>
<span class="lineno">  191 </span>
<span class="lineno">  192 </span>-- | A função 'removeElementosRepetidos' remove todos os elementos repetidos numa lista.
<span class="lineno">  193 </span>--
<span class="lineno">  194 </span>-- == Exemplos
<span class="lineno">  195 </span>--
<span class="lineno">  196 </span>-- &gt;&gt;&gt; removeElementosRepetidos [1,2,3,4,4,5,5]
<span class="lineno">  197 </span>-- [1,2,3,4,5]
<span class="lineno">  198 </span>--
<span class="lineno">  199 </span>-- &gt;&gt;&gt; removeElementosRepetidos [1,2,3,4,5]
<span class="lineno">  200 </span>-- [1,2,3,4,5]
<span class="lineno">  201 </span>
<span class="lineno">  202 </span>removeElementosRepetidos :: Eq a =&gt; 
<span class="lineno">  203 </span> -- | Lista inicial.
<span class="lineno">  204 </span> [a] -&gt;
<span class="lineno">  205 </span> -- | Lista resultante.
<span class="lineno">  206 </span> [a]
<span class="lineno">  207 </span><span class="decl"><span class="istickedoff">removeElementosRepetidos [] = []</span>
<span class="lineno">  208 </span><span class="spaces"></span><span class="istickedoff">removeElementosRepetidos (h:t)</span>
<span class="lineno">  209 </span><span class="spaces">    </span><span class="istickedoff">| h `elem` t = removeElementosRepetidos t</span>
<span class="lineno">  210 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = h : removeElementosRepetidos t</span></span>
<span class="lineno">  211 </span>
<span class="lineno">  212 </span>
<span class="lineno">  213 </span>
<span class="lineno">  214 </span>
<span class="lineno">  215 </span>
<span class="lineno">  216 </span>-- {- Funções relativas aos portais -} --
<span class="lineno">  217 </span>
<span class="lineno">  218 </span>-- | __(1.a)__ A função 'verifExistPortais' verifica se existe pelo menos um portal durante o jogo.
<span class="lineno">  219 </span>--
<span class="lineno">  220 </span>-- == Exemplos
<span class="lineno">  221 </span>--
<span class="lineno">  222 </span>-- &gt;&gt;&gt; verifExistPortais []
<span class="lineno">  223 </span>-- False
<span class="lineno">  224 </span>--
<span class="lineno">  225 </span>-- &gt;&gt;&gt; verifExistPortais [Portal (2,2) []]
<span class="lineno">  226 </span>-- True
<span class="lineno">  227 </span>
<span class="lineno">  228 </span>verifExistPortais :: 
<span class="lineno">  229 </span> -- | Lista dos portais.
<span class="lineno">  230 </span> [Portal] -&gt; 
<span class="lineno">  231 </span> -- | Resultado na forma 'True' caso existe pelo menos um portal ou 'False' caso contrário.
<span class="lineno">  232 </span> Bool
<span class="lineno">  233 </span><span class="decl"><span class="istickedoff">verifExistPortais portais = not $ null portais</span></span>
<span class="lineno">  234 </span>
<span class="lineno">  235 </span>-- | __(1.b)__ A função 'verifPortaisSobreTerra' verifica se todos os portais do jogo estão posicionados sobre terra.
<span class="lineno">  236 </span>--
<span class="lineno">  237 </span>-- == Exemplos
<span class="lineno">  238 </span>--
<span class="lineno">  239 </span>-- &gt;&gt;&gt; verifPortaisSobreTerra [(1,0)] mapa01
<span class="lineno">  240 </span>-- True
<span class="lineno">  241 </span>--
<span class="lineno">  242 </span>-- &gt;&gt;&gt; verifPortaisSobreTerra [(2,0)] mapa01
<span class="lineno">  243 </span>-- False
<span class="lineno">  244 </span>--
<span class="lineno">  245 </span>-- &gt;&gt;&gt; verifPortaisSobreTerra [(1,0),(2,0)] mapa01
<span class="lineno">  246 </span>-- False
<span class="lineno">  247 </span>
<span class="lineno">  248 </span>verifPortaisSobreTerra :: 
<span class="lineno">  249 </span> -- | Posições dos portais.
<span class="lineno">  250 </span> [Posicao] -&gt;
<span class="lineno">  251 </span> -- | Mapa do jogo.
<span class="lineno">  252 </span> Mapa -&gt;
<span class="lineno">  253 </span> -- | Resultado na forma 'True' se todos os portais estão no caminho do terra ou 'False' caso contrário.
<span class="lineno">  254 </span> Bool
<span class="lineno">  255 </span><span class="decl"><span class="istickedoff">verifPortaisSobreTerra [] _ = True</span>
<span class="lineno">  256 </span><span class="spaces"></span><span class="istickedoff">verifPortaisSobreTerra (h:t) mapa = verifPortaisSobreTerraAux h mapa &amp;&amp; verifPortaisSobreTerra t mapa</span>
<span class="lineno">  257 </span><span class="spaces">    </span><span class="istickedoff">where verifPortaisSobreTerraAux :: Posicao -&gt; Mapa -&gt; Bool</span>
<span class="lineno">  258 </span><span class="spaces">          </span><span class="istickedoff">verifPortaisSobreTerraAux (x,y) m = (m !! round y) !! round x == Terra</span></span>
<span class="lineno">  259 </span>
<span class="lineno">  260 </span>-- | __(1.c)__ A função 'verifConexaoBasePortais' verifica se existe, começando na base, um caminho de terra até a pelo menos um portal.
<span class="lineno">  261 </span>--
<span class="lineno">  262 </span>-- == Exemplos
<span class="lineno">  263 </span>--
<span class="lineno">  264 </span>-- &gt;&gt;&gt; verifConexaoBasePortais (0,0) [(2,3)] (filtraPosicoesTerra mapa01 (0,0))
<span class="lineno">  265 </span>-- True
<span class="lineno">  266 </span>--
<span class="lineno">  267 </span>-- &gt;&gt;&gt; verifConexaoBasePortais (0,0) [(4,0)] (filtraPosicoesTerra mapa01 (0,0))
<span class="lineno">  268 </span>-- False
<span class="lineno">  269 </span>--
<span class="lineno">  270 </span>-- &gt;&gt;&gt;verifConexaoBasePortais (0,0) [(2,3),(4,0)] (filtraPosicoesTerra mapa01 (0,0))
<span class="lineno">  271 </span>-- False
<span class="lineno">  272 </span>
<span class="lineno">  273 </span>verifConexaoBasePortais :: 
<span class="lineno">  274 </span> -- | Posição da base.
<span class="lineno">  275 </span> Posicao -&gt; 
<span class="lineno">  276 </span> -- | Posições dos portais.
<span class="lineno">  277 </span> [Posicao] -&gt; 
<span class="lineno">  278 </span> -- | Posições dos caminhos de terra.
<span class="lineno">  279 </span> [Posicao] -&gt; 
<span class="lineno">  280 </span> -- | Resultado na forma 'True' se existe algum caminho (de terra) da base a um dos portais ou 'False' se não existe tal caminho.
<span class="lineno">  281 </span> Bool
<span class="lineno">  282 </span><span class="decl"><span class="istickedoff">verifConexaoBasePortais _ _ [] = <span class="nottickedoff">False</span></span>
<span class="lineno">  283 </span><span class="spaces"></span><span class="istickedoff">verifConexaoBasePortais posBase posicoesPortais posicoesTerra = or (map (`elem` posicoesDisponiveis) posicoesPortais)</span>
<span class="lineno">  284 </span><span class="spaces">    </span><span class="istickedoff">where posicoesDisponiveis = removeElementosRepetidos (posicoesPossiveisParaPortais posicoesTerra posBase)</span></span>
<span class="lineno">  285 </span>
<span class="lineno">  286 </span>-- | A função 'posicoesPossiveisParaPortais' determina todas as posições que um portal pode ocupar num mapa, isto é, apenas as posições correspondentes a caminhos de terra
<span class="lineno">  287 </span>-- que estão ligados à base.
<span class="lineno">  288 </span>--
<span class="lineno">  289 </span>-- == Exemplos
<span class="lineno">  290 </span>--
<span class="lineno">  291 </span>-- &gt;&gt;&gt; posicoesPossiveisParaPortais (filtraPosicoesTerra mapa01 (0,0)) (0,0)
<span class="lineno">  292 </span>-- [(0.0,0.0),(1.0,0.0),(1.0,1.0),(1.0,2.0),(1.0,3.0),(2.0,3.0),(2.0,4.0),(1.0,4.0),(3.0,4.0),(4.0,4.0),(5.0,4.0),(5.0,3.0),(5.0,2.0),(1.0,4.0),(2.0,4.0),(2.0,3.0),(3.0,4.0),(4.0,4.0),(5.0,4.0),(5.0,3.0),(5.0,2.0)]
<span class="lineno">  293 </span>--
<span class="lineno">  294 </span>-- &gt;&gt;&gt; posicoesPossiveisParaPortais (filtraPosicoesTerra mapa01 (0,0)) (4,0)
<span class="lineno">  295 </span>-- [(4.0,0.0),(4.0,1.0)]
<span class="lineno">  296 </span>
<span class="lineno">  297 </span>posicoesPossiveisParaPortais ::
<span class="lineno">  298 </span> -- | Posições de terra do mapa.
<span class="lineno">  299 </span> [Posicao] -&gt;
<span class="lineno">  300 </span> -- | Posição da base.
<span class="lineno">  301 </span> Posicao -&gt;
<span class="lineno">  302 </span> -- | Posições possíveis para portais.
<span class="lineno">  303 </span> [Posicao]
<span class="lineno">  304 </span><span class="decl"><span class="istickedoff">posicoesPossiveisParaPortais posicoesTerra posBase</span>
<span class="lineno">  305 </span><span class="spaces">    </span><span class="istickedoff">| null pontosAdj = [posBase]</span>
<span class="lineno">  306 </span><span class="spaces">    </span><span class="istickedoff">| compPontosAdj == 1 = posBase : posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (head pontosAdj)</span>
<span class="lineno">  307 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">compPontosAdj == 2</span> = posBase : posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (head pontosAdj) ++</span>
<span class="lineno">  308 </span><span class="spaces">                           </span><span class="istickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (last pontosAdj)</span>
<span class="lineno">  309 </span><span class="spaces">    </span><span class="istickedoff">| <span class="nottickedoff">compPontosAdj == 3</span> = <span class="nottickedoff">posBase : posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (head pontosAdj) ++</span></span>
<span class="lineno">  310 </span><span class="spaces">                           </span><span class="istickedoff"><span class="nottickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (pontosAdj !! 1) ++</span></span>
<span class="lineno">  311 </span><span class="spaces">                           </span><span class="istickedoff"><span class="nottickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (last pontosAdj)</span></span>
<span class="lineno">  312 </span><span class="spaces">    </span><span class="istickedoff">| <span class="nottickedoff">compPontosAdj == 4</span> = <span class="nottickedoff">posBase : posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (head pontosAdj) ++</span></span>
<span class="lineno">  313 </span><span class="spaces">                           </span><span class="istickedoff"><span class="nottickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (pontosAdj !! 1) ++</span></span>
<span class="lineno">  314 </span><span class="spaces">                           </span><span class="istickedoff"><span class="nottickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (pontosAdj !! 2) ++</span></span>
<span class="lineno">  315 </span><span class="spaces">                           </span><span class="istickedoff"><span class="nottickedoff">posicoesPossiveisParaPortais (removeElemento posBase posicoesTerra) (last pontosAdj)</span></span>
<span class="lineno">  316 </span><span class="spaces">        </span><span class="istickedoff">where pontosAdj = encontraPontosAdjacentes posBase posicoesTerra</span>
<span class="lineno">  317 </span><span class="spaces">              </span><span class="istickedoff">compPontosAdj = length pontosAdj</span></span>
<span class="lineno">  318 </span>
<span class="lineno">  319 </span>-- | __(1.d)__ A função 'verifSobreposPortaisTorresBase' verifica se há sobreposição dos portais com as torres ou com a base.
<span class="lineno">  320 </span>--
<span class="lineno">  321 </span>-- == Exemplos
<span class="lineno">  322 </span>--
<span class="lineno">  323 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(0,0),(3,3)] [(1,1),(2,2)] (3,4)
<span class="lineno">  324 </span>-- True
<span class="lineno">  325 </span>--
<span class="lineno">  326 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(0,0),(3,3)] [(1,1),(2,2)] (3,3)
<span class="lineno">  327 </span>-- False
<span class="lineno">  328 </span>--
<span class="lineno">  329 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(0,0)] [(1,1),(2,2)] (3,3)
<span class="lineno">  330 </span>-- True
<span class="lineno">  331 </span>--
<span class="lineno">  332 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(0,0),(3,3)] [(1,1),(2,2),(0,0)] (3,4)
<span class="lineno">  333 </span>-- False
<span class="lineno">  334 </span>--
<span class="lineno">  335 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(3,3)] [(1,1),(2,2)] (3,4)
<span class="lineno">  336 </span>-- True
<span class="lineno">  337 </span>--
<span class="lineno">  338 </span>-- &gt;&gt;&gt; verifSobreposPortaisTorresBase [(0,0),(3,3)] [(1,1),(3,3)] (0,0)
<span class="lineno">  339 </span>-- False
<span class="lineno">  340 </span>
<span class="lineno">  341 </span>verifSobreposPortaisTorresBase :: 
<span class="lineno">  342 </span> -- | Posições dos portais.
<span class="lineno">  343 </span> [Posicao] -&gt; 
<span class="lineno">  344 </span> -- | Posições das torres.
<span class="lineno">  345 </span> [Posicao] -&gt;
<span class="lineno">  346 </span> -- | Posição da base.
<span class="lineno">  347 </span> Posicao -&gt;
<span class="lineno">  348 </span> -- | Resultado na forma 'True' se não há qualquer sobreposição ou 'False' se há alguma sobreposição.
<span class="lineno">  349 </span> Bool
<span class="lineno">  350 </span><span class="decl"><span class="istickedoff">verifSobreposPortaisTorresBase [] _ _ = True</span>
<span class="lineno">  351 </span><span class="spaces"></span><span class="istickedoff">verifSobreposPortaisTorresBase (p:ps) torres base</span>
<span class="lineno">  352 </span><span class="spaces">    </span><span class="istickedoff">| p `elem` bt = False</span>
<span class="lineno">  353 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = verifSobreposPortaisTorresBase ps torres base</span>
<span class="lineno">  354 </span><span class="spaces">        </span><span class="istickedoff">where bt = base : torres</span></span>
<span class="lineno">  355 </span>
<span class="lineno">  356 </span>-- | __(1.e)__ A função 'verifOndasAtivasPorPortal' verifica se há, no máximo, uma onda ativa para um dado portal.
<span class="lineno">  357 </span>--
<span class="lineno">  358 </span>-- == Exemplos
<span class="lineno">  359 </span>--
<span class="lineno">  360 </span>-- &gt;&gt;&gt; verifOndasAtivasPorPortal (Portal (0,0) [Onda [Inimigo (0,0) Norte 5 5 5 5 [] [] 5 1] 5 5 5,Onda [Inimigo (1,1) Este 10 10 10 10 [] [] 10 1] 10 10 10])
<span class="lineno">  361 </span>-- True
<span class="lineno">  362 </span>--
<span class="lineno">  363 </span>-- &gt;&gt;&gt; verifOndasAtivasPorPortal (Portal (0,0) [Onda [] 5 5 (-5),Onda [] 10 10 (-10)])
<span class="lineno">  364 </span>-- True
<span class="lineno">  365 </span>--
<span class="lineno">  366 </span>-- &gt;&gt;&gt; verifOndasAtivasPorPortal (Portal (0,0) [Onda [Inimigo (0,0) Norte 5 5 5 5 [] [] 5 1] 5 5 (-5),Onda [] 10 10 (-10)]) ~=? True
<span class="lineno">  367 </span>-- True
<span class="lineno">  368 </span>--
<span class="lineno">  369 </span>-- &gt;&gt;&gt; verifOndasAtivasPorPortal (Portal (0,0) [Onda [Inimigo (0,0) Norte 5 5 5 5 [] [] 5 1] 5 5 (-5),Onda [Inimigo (1,1) Este 10 10 10 10 [] [] 10 1] 10 10 (-10)])
<span class="lineno">  370 </span>-- False
<span class="lineno">  371 </span>
<span class="lineno">  372 </span>verifOndasAtivasPorPortal :: 
<span class="lineno">  373 </span> -- | Portal de escolha.
<span class="lineno">  374 </span> Portal -&gt;
<span class="lineno">  375 </span> -- | Resultado na forma 'True' se não há mais que uma onda ativa para o portal escolhido ou 'False' caso contrário.
<span class="lineno">  376 </span> Bool
<span class="lineno">  377 </span><span class="decl"><span class="istickedoff">verifOndasAtivasPorPortal portal = verifOndasAtivasPorPortalAux ondas</span>
<span class="lineno">  378 </span><span class="spaces">        </span><span class="istickedoff">where ondas = ondasPortal portal</span>
<span class="lineno">  379 </span><span class="spaces">              </span><span class="istickedoff">verifOndaAtiva onda = not (null (inimigosOnda onda)) &amp;&amp; entradaOnda onda &lt; 0</span>
<span class="lineno">  380 </span><span class="spaces">              </span><span class="istickedoff">verifOndasAtivasPorPortalAux [] = <span class="nottickedoff">True</span></span>
<span class="lineno">  381 </span><span class="spaces">              </span><span class="istickedoff">verifOndasAtivasPorPortalAux onds = length (filter verifOndaAtiva onds) &lt;= 1</span></span>
<span class="lineno">  382 </span>
<span class="lineno">  383 </span>
<span class="lineno">  384 </span>
<span class="lineno">  385 </span>
<span class="lineno">  386 </span>
<span class="lineno">  387 </span>-- {- Funções relativas aos inimigos -} --
<span class="lineno">  388 </span>
<span class="lineno">  389 </span>-- | __(2.a)__ A função 'verifInimigosInativos' verifica se os inimigos inativos (ainda por sair do portal) estão nas condições corretas, isto é,
<span class="lineno">  390 </span>-- estão na posição do seu portal, possuem vida positiva e não possuem projéteis ativos.
<span class="lineno">  391 </span>--
<span class="lineno">  392 </span>-- == Exemplos
<span class="lineno">  393 </span>--
<span class="lineno">  394 </span>-- &gt;&gt;&gt; verifInimigosInativos (Portal (2,2) [])
<span class="lineno">  395 </span>-- True
<span class="lineno">  396 </span>--
<span class="lineno">  397 </span>-- &gt;&gt;&gt; verifInimigosInativos (Portal (2,2) [Onda [Inimigo (2,2) Norte 1 1 1 1 [] [] 1 1] 1 1 1])
<span class="lineno">  398 </span>-- True
<span class="lineno">  399 </span>--
<span class="lineno">  400 </span>-- &gt;&gt;&gt; verifInimigosInativos (Portal (2,2) [Onda [Inimigo (2,3) Norte 1 1 1 1 [] [] 1 1] 1 1 1])
<span class="lineno">  401 </span>-- False
<span class="lineno">  402 </span>--
<span class="lineno">  403 </span>-- &gt;&gt;&gt; verifInimigosInativos (Portal (2,2) [Onda [Inimigo (2,2) Norte 0 1 1 1 [] [] 1 1] 1 1 1])
<span class="lineno">  404 </span>-- False
<span class="lineno">  405 </span>--
<span class="lineno">  406 </span>-- &gt;&gt;&gt; verifInimigosInativos (Portal (2,2) [Onda [Inimigo (2,2) Norte 1 1 1 1 [Projetil Fogo (Finita 1)] [] 1 1] 1 1 1])
<span class="lineno">  407 </span>-- False
<span class="lineno">  408 </span>
<span class="lineno">  409 </span>verifInimigosInativos :: 
<span class="lineno">  410 </span> -- | Portal do qual os inimigos irão sair.
<span class="lineno">  411 </span> Portal -&gt;
<span class="lineno">  412 </span> -- | Resultado na forma 'True' se todas as condições são verificadas ou 'False' se pelo menos uma não está correta.
<span class="lineno">  413 </span> Bool
<span class="lineno">  414 </span><span class="decl"><span class="istickedoff">verifInimigosInativos portal = verifPosicaoInimigoPortal inimigosInativos posPortal &amp;&amp; vidaInimigoPositiva inimigosInativos &amp;&amp; listaProjeteisAtivosInimigos inimigosInativos</span>
<span class="lineno">  415 </span><span class="spaces">    </span><span class="istickedoff">where posPortal = posicaoPortal portal</span>
<span class="lineno">  416 </span><span class="spaces">          </span><span class="istickedoff">inimigosInativos = map inimigosOnda (ondasPortal portal)</span></span>
<span class="lineno">  417 </span>
<span class="lineno">  418 </span>-- | A função 'verifPosicaoInimigoPortal' verifica se as posições dos inimigos de um portal coincidem com a posição do próprio portal.
<span class="lineno">  419 </span>--
<span class="lineno">  420 </span>-- == Exemplos
<span class="lineno">  421 </span>--
<span class="lineno">  422 </span>-- &gt;&gt;&gt; verifPosicaoInimigoPortal [[Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1]] (1,1)
<span class="lineno">  423 </span>-- True
<span class="lineno">  424 </span>--
<span class="lineno">  425 </span>-- &gt;&gt;&gt; verifPosicaoInimigoPortal [[Inimigo (1,2) Norte 1 1 1 1 [] [] 1 1]] (1,1)
<span class="lineno">  426 </span>-- False
<span class="lineno">  427 </span>--
<span class="lineno">  428 </span>-- &gt;&gt;&gt; verifPosicaoInimigoPortal [[Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1],[Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1]] (1,1)
<span class="lineno">  429 </span>-- False
<span class="lineno">  430 </span>
<span class="lineno">  431 </span>verifPosicaoInimigoPortal :: 
<span class="lineno">  432 </span> -- | Inimigos do portal.
<span class="lineno">  433 </span> [[Inimigo]] -&gt; 
<span class="lineno">  434 </span> -- | Posição do portal.
<span class="lineno">  435 </span> Posicao -&gt; 
<span class="lineno">  436 </span> -- | Resultado na forma 'True' caso todos os inimigos estão na posição do seu portal ou 'False' caso contrário.
<span class="lineno">  437 </span> Bool
<span class="lineno">  438 </span><span class="decl"><span class="istickedoff">verifPosicaoInimigoPortal [] _ = True</span>
<span class="lineno">  439 </span><span class="spaces"></span><span class="istickedoff">verifPosicaoInimigoPortal (li:lsi) pos = and (map (pos ==) (map posicaoInimigo li)) &amp;&amp; verifPosicaoInimigoPortal lsi pos</span></span>
<span class="lineno">  440 </span>
<span class="lineno">  441 </span>-- | A função 'vidaInimigoPositiva' verifica se todos os inimigos de um portal possuem vida positiva.
<span class="lineno">  442 </span>--
<span class="lineno">  443 </span>-- == Exemplos
<span class="lineno">  444 </span>--
<span class="lineno">  445 </span>-- &gt;&gt;&gt; vidaInimigoPositiva [[Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1]]
<span class="lineno">  446 </span>-- True
<span class="lineno">  447 </span>--
<span class="lineno">  448 </span>-- &gt;&gt;&gt;  vidaInimigoPositiva [[Inimigo (1,1) Norte (-1) 1 1 1 [] [] 1 1]] ~=? False
<span class="lineno">  449 </span>-- False
<span class="lineno">  450 </span>--
<span class="lineno">  451 </span>-- &gt;&gt;&gt; vidaInimigoPositiva [[Inimigo (1,1) Norte (-1) 1 1 1 [] [] 1 1],[Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1]]
<span class="lineno">  452 </span>-- False
<span class="lineno">  453 </span>
<span class="lineno">  454 </span>vidaInimigoPositiva :: 
<span class="lineno">  455 </span> -- | Inimigos do portal.
<span class="lineno">  456 </span> [[Inimigo]] -&gt; 
<span class="lineno">  457 </span> -- | Resultado na forma 'True' se nenhum inimigo possui vida não positiva ou 'False' se pelo menos um não respeita a condição.
<span class="lineno">  458 </span> Bool
<span class="lineno">  459 </span><span class="decl"><span class="istickedoff">vidaInimigoPositiva [] = True</span>
<span class="lineno">  460 </span><span class="spaces"></span><span class="istickedoff">vidaInimigoPositiva (li:lsi) = and (map (&gt; 0) (map vidaInimigo li)) &amp;&amp; vidaInimigoPositiva lsi</span></span>
<span class="lineno">  461 </span>
<span class="lineno">  462 </span>-- | A função 'listaProjeteisAtivosInimigos' verifica se nenhum inimigo num portal possui projéteis ativos.
<span class="lineno">  463 </span>--
<span class="lineno">  464 </span>-- == Exemplos
<span class="lineno">  465 </span>--
<span class="lineno">  466 </span>-- &gt;&gt;&gt; listaProjeteisAtivosInimigos [[Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1]]
<span class="lineno">  467 </span>-- True
<span class="lineno">  468 </span>--
<span class="lineno">  469 </span>-- &gt;&gt;&gt; listaProjeteisAtivosInimigos [[Inimigo (1,1) Norte 1 1 1 1 [Projetil Fogo (Finita 1)] [] 1 1]]
<span class="lineno">  470 </span>-- False
<span class="lineno">  471 </span>--
<span class="lineno">  472 </span>-- &gt;&gt;&gt; listaProjeteisAtivosInimigos [[Inimigo (1,1) Norte 1 1 1 1 [Projetil Fogo (Finita 1)] [] 1 1],[Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1]]
<span class="lineno">  473 </span>-- False
<span class="lineno">  474 </span>
<span class="lineno">  475 </span>listaProjeteisAtivosInimigos :: 
<span class="lineno">  476 </span> -- | Inimigos do portal.
<span class="lineno">  477 </span> [[Inimigo]] -&gt; 
<span class="lineno">  478 </span> -- | Resultado na forma 'True' se nenhum inimgo possui projéteis ativos ou 'False' caso contrário.
<span class="lineno">  479 </span> Bool
<span class="lineno">  480 </span><span class="decl"><span class="istickedoff">listaProjeteisAtivosInimigos [] = True</span>
<span class="lineno">  481 </span><span class="spaces"></span><span class="istickedoff">listaProjeteisAtivosInimigos (li:lsi) = and (map null (map projeteisInimigo li)) &amp;&amp; listaProjeteisAtivosInimigos lsi</span></span>
<span class="lineno">  482 </span>
<span class="lineno">  483 </span>-- | __(2.b)__ A função 'todosInimigosSobreTerra' verifica se todos os inimigos ativos no jogo estão posicionados sobre terreno de terra.
<span class="lineno">  484 </span>--
<span class="lineno">  485 </span>-- == Exemplos
<span class="lineno">  486 </span>--
<span class="lineno">  487 </span>-- &gt;&gt;&gt; todosInimigosSobreTerra [(1,1),(2,3)] (filtraPosicoesTerra mapa01 (0,0))
<span class="lineno">  488 </span>-- True
<span class="lineno">  489 </span>--
<span class="lineno">  490 </span>-- &gt;&gt;&gt; todosInimigosSobreTerra [(1,1),(2,3),(2,0)] (filtraPosicoesTerra mapa01 (0,0))
<span class="lineno">  491 </span>-- False
<span class="lineno">  492 </span>
<span class="lineno">  493 </span>todosInimigosSobreTerra :: 
<span class="lineno">  494 </span> -- | Posições dos inimigos.
<span class="lineno">  495 </span> [Posicao] -&gt;
<span class="lineno">  496 </span> -- | Posições de terreno de terra.
<span class="lineno">  497 </span> [Posicao] -&gt;
<span class="lineno">  498 </span> -- | Resultado na forma 'True' se todos os inimigos estão posicionados sobre terra ou 'False' caso contrário.
<span class="lineno">  499 </span> Bool
<span class="lineno">  500 </span><span class="decl"><span class="istickedoff">todosInimigosSobreTerra [] _ = True</span>
<span class="lineno">  501 </span><span class="spaces"></span><span class="istickedoff">todosInimigosSobreTerra (pi:pis) pst</span>
<span class="lineno">  502 </span><span class="spaces">    </span><span class="istickedoff">| pi `elem` pst = todosInimigosSobreTerra pis pst</span>
<span class="lineno">  503 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = False</span></span>
<span class="lineno">  504 </span>
<span class="lineno">  505 </span>-- | __(2.c)__ A função 'inimigosSobreposTorres' verifica se nenhum inimigo se encontra posicionado sobre uma torre.
<span class="lineno">  506 </span>--
<span class="lineno">  507 </span>-- == Exemplos
<span class="lineno">  508 </span>--
<span class="lineno">  509 </span>-- &gt;&gt;&gt; inimigosSobreposTorres [Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1,Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1] [Torre (2,0) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1]
<span class="lineno">  510 </span>-- True
<span class="lineno">  511 </span>--
<span class="lineno">  512 </span>-- &gt;&gt;&gt; inimigosSobreposTorres [Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1,Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1] [Torre (2,2) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1]
<span class="lineno">  513 </span>-- False
<span class="lineno">  514 </span>--
<span class="lineno">  515 </span>-- &gt;&gt;&gt; inimigosSobreposTorres [Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1,Inimigo (2,0) Norte 2 2 2 2 [] [] 2 1] [Torre (2,0) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1]
<span class="lineno">  516 </span>-- False
<span class="lineno">  517 </span>
<span class="lineno">  518 </span>inimigosSobreposTorres :: 
<span class="lineno">  519 </span> -- | Lista de inimigos.
<span class="lineno">  520 </span> [Inimigo] -&gt;
<span class="lineno">  521 </span> -- | Lista de torres.
<span class="lineno">  522 </span> [Torre] -&gt;
<span class="lineno">  523 </span> -- | Resultado na forma 'True' se nenhum inimigo se encontra posicionado sobre uma torre ou 'False' caso contrário.
<span class="lineno">  524 </span> Bool
<span class="lineno">  525 </span><span class="decl"><span class="istickedoff">inimigosSobreposTorres [] _ = True</span>
<span class="lineno">  526 </span><span class="spaces"></span><span class="istickedoff">inimigosSobreposTorres (i:is) torres</span>
<span class="lineno">  527 </span><span class="spaces">    </span><span class="istickedoff">| pi `elem` pst = False</span>
<span class="lineno">  528 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = inimigosSobreposTorres is torres</span>
<span class="lineno">  529 </span><span class="spaces">        </span><span class="istickedoff">where pi = posicaoInimigo i</span>
<span class="lineno">  530 </span><span class="spaces">              </span><span class="istickedoff">pst = map posicaoTorre torres</span></span>
<span class="lineno">  531 </span>
<span class="lineno">  532 </span>-- | __(2.d)__ A função 'velocidadeInimigosNaoNegativa' verifica se nenhum inimigo possui velocidade negativa.
<span class="lineno">  533 </span>--
<span class="lineno">  534 </span>-- == Exemplos
<span class="lineno">  535 </span>--
<span class="lineno">  536 </span>-- &gt;&gt;&gt; velocidadeInimigosNaoNegativa [Inimigo (1,1) Norte 1 1 1 1 [] [] 1 1,Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1]
<span class="lineno">  537 </span>-- True
<span class="lineno">  538 </span>--
<span class="lineno">  539 </span>-- &gt;&gt;&gt; velocidadeInimigosNaoNegativa [Inimigo (1,1) Norte 1 0 1 1 [] [] 1 1,Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1]
<span class="lineno">  540 </span>-- True
<span class="lineno">  541 </span>--
<span class="lineno">  542 </span>-- &gt;&gt;&gt; velocidadeInimigosNaoNegativa [Inimigo (1,1) Norte 1 (-1) 1 1 [] [] 1 1,Inimigo (2,2) Norte 2 2 2 2 [] [] 2 1]
<span class="lineno">  543 </span>-- False
<span class="lineno">  544 </span>
<span class="lineno">  545 </span>velocidadeInimigosNaoNegativa :: 
<span class="lineno">  546 </span> -- | Lista de Inimigos
<span class="lineno">  547 </span> [Inimigo] -&gt;
<span class="lineno">  548 </span> -- | Resultado na forma 'True' caso todos os inimigos possuem velocidade não negativa ou 'False' caso contrário.
<span class="lineno">  549 </span> Bool
<span class="lineno">  550 </span><span class="decl"><span class="istickedoff">velocidadeInimigosNaoNegativa inimigos = and (map (&gt;= 0) velocidadesInimigos)</span>
<span class="lineno">  551 </span><span class="spaces">    </span><span class="istickedoff">where velocidadesInimigos = map velocidadeInimigo inimigos</span></span>
<span class="lineno">  552 </span>
<span class="lineno">  553 </span>-- | __(2.e)__ A função 'verifProjeteisNormalizados' verifica se os projéteis de uma lista estão normalizados, ou seja, não pode haver vários projéteis do mesmo tipo
<span class="lineno">  554 </span>-- e não pode haver, simultâneamente, projéteis de gelo e fogo nem de resina e fogo.
<span class="lineno">  555 </span>--
<span class="lineno">  556 </span>-- == Exemplos
<span class="lineno">  557 </span>--
<span class="lineno">  558 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Fogo Infinita]
<span class="lineno">  559 </span>-- True
<span class="lineno">  560 </span>--
<span class="lineno">  561 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Fogo Infinita,Projetil Fogo (Finita 1)]
<span class="lineno">  562 </span>-- False
<span class="lineno">  563 </span>--
<span class="lineno">  564 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Fogo Infinita,Projetil Gelo (Finita 1)]
<span class="lineno">  565 </span>-- False
<span class="lineno">  566 </span>--
<span class="lineno">  567 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Fogo Infinita,Projetil Resina Infinita]
<span class="lineno">  568 </span>-- False
<span class="lineno">  569 </span>--
<span class="lineno">  570 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Gelo Infinita,Projetil Resina Infinita]
<span class="lineno">  571 </span>-- True
<span class="lineno">  572 </span>--
<span class="lineno">  573 </span>-- &gt;&gt;&gt; verifProjeteisNormalizados [Projetil Gelo Infinita,Projetil Resina Infinita,Projetil Fraqueza Infinita]
<span class="lineno">  574 </span>-- True
<span class="lineno">  575 </span>
<span class="lineno">  576 </span>verifProjeteisNormalizados :: 
<span class="lineno">  577 </span> -- | Lista de projéteis.
<span class="lineno">  578 </span> [Projetil] -&gt;
<span class="lineno">  579 </span> -- | Resultado na forma 'True' se os projéteis estão normalizados ou 'False' caso contrário.
<span class="lineno">  580 </span> Bool
<span class="lineno">  581 </span><span class="decl"><span class="istickedoff">verifProjeteisNormalizados [] = <span class="nottickedoff">True</span></span>
<span class="lineno">  582 </span><span class="spaces"></span><span class="istickedoff">verifProjeteisNormalizados projeteis</span>
<span class="lineno">  583 </span><span class="spaces">    </span><span class="istickedoff">| null tps = True</span>
<span class="lineno">  584 </span><span class="spaces">    </span><span class="istickedoff">| tp == Fogo &amp;&amp; ((Fogo `elem` tps) || (Gelo `elem` tps) || (Resina `elem` tps)) = False</span>
<span class="lineno">  585 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlyfalse">tp == Gelo &amp;&amp; (Fogo `elem` tps || Gelo `elem` tps)</span> = <span class="nottickedoff">False</span></span>
<span class="lineno">  586 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlyfalse">tp == Resina &amp;&amp; (Fogo `elem` tps || Resina `elem` tps)</span> = <span class="nottickedoff">False</span></span>
<span class="lineno">  587 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = verifProjeteisNormalizados (tail projeteis)</span>
<span class="lineno">  588 </span><span class="spaces">        </span><span class="istickedoff">where (tp:tps) = map tipoProjetil projeteis</span></span>
<span class="lineno">  589 </span>
<span class="lineno">  590 </span>
<span class="lineno">  591 </span>
<span class="lineno">  592 </span>
<span class="lineno">  593 </span>
<span class="lineno">  594 </span>-- {- Funções relativas às torres -} --
<span class="lineno">  595 </span>
<span class="lineno">  596 </span>-- | __(3.a)__ A função 'verifTorresSobreRelva' verifica se todas as torres estão posicionadas em terreno de relva.
<span class="lineno">  597 </span>--
<span class="lineno">  598 </span>-- == Exemplos
<span class="lineno">  599 </span>--
<span class="lineno">  600 </span>-- &gt;&gt;&gt; verifTorresSobreRelva [Torre (2,0) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1] mapa01
<span class="lineno">  601 </span>-- True
<span class="lineno">  602 </span>--
<span class="lineno">  603 </span>-- &gt;&gt;&gt; verifTorresSobreRelva [Torre (1,0) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1] mapa01
<span class="lineno">  604 </span>-- False
<span class="lineno">  605 </span>--
<span class="lineno">  606 </span>-- &gt;&gt;&gt; verifTorresSobreRelva [Torre (2,0) 1 1 1 1 1 (Projetil Gelo Infinita) 1 1,Torre (1,0) 1 1 1 1 1 (Projetil Fogo Infinita) 1 1] mapa01
<span class="lineno">  607 </span>-- False
<span class="lineno">  608 </span>
<span class="lineno">  609 </span>verifTorresSobreRelva ::
<span class="lineno">  610 </span> -- | Lista de torres.
<span class="lineno">  611 </span> [Torre] -&gt;
<span class="lineno">  612 </span> -- | Mapa do jogo.
<span class="lineno">  613 </span> Mapa -&gt;
<span class="lineno">  614 </span> -- | Resultado na forma 'True' caso todas as torres estão posicionadas sobre relva ou 'False' caso contrário.
<span class="lineno">  615 </span> Bool
<span class="lineno">  616 </span><span class="decl"><span class="istickedoff">verifTorresSobreRelva [] _ = True</span>
<span class="lineno">  617 </span><span class="spaces"></span><span class="istickedoff">verifTorresSobreRelva torres mapa</span>
<span class="lineno">  618 </span><span class="spaces">    </span><span class="istickedoff">| pt `elem` pr = verifTorresSobreRelva (tail torres) mapa</span>
<span class="lineno">  619 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = False</span>
<span class="lineno">  620 </span><span class="spaces">        </span><span class="istickedoff">where pt = posicaoTorre (head torres)</span>
<span class="lineno">  621 </span><span class="spaces">              </span><span class="istickedoff">pr = filtraPosicoesRelva mapa (<span class="nottickedoff">0</span>,0)</span></span>
<span class="lineno">  622 </span>
<span class="lineno">  623 </span>-- | __(3.b)__ A função 'verifAlcanceTorres' verifica se todas as torres possuem um alcance não negativo.
<span class="lineno">  624 </span>--
<span class="lineno">  625 </span>-- == Exemplos
<span class="lineno">  626 </span>--
<span class="lineno">  627 </span>-- &gt;&gt;&gt; verifAlcanceTorres [Torre (1,1) 1 1 1 1 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  628 </span>-- True
<span class="lineno">  629 </span>--
<span class="lineno">  630 </span>-- &gt;&gt;&gt; verifAlcanceTorres [Torre (1,1) 1 0 1 1 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  631 </span>-- True
<span class="lineno">  632 </span>--
<span class="lineno">  633 </span>-- &gt;&gt;&gt; verifAlcanceTorres [Torre (1,1) 1 (-1) 1 1 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  634 </span>-- False
<span class="lineno">  635 </span>
<span class="lineno">  636 </span>verifAlcanceTorres ::
<span class="lineno">  637 </span> -- | Lista de torres.
<span class="lineno">  638 </span> [Torre] -&gt;
<span class="lineno">  639 </span> -- | Resultado na forma 'True' se nenhuma torre possui alcance negativo ou 'False' se pelo menos uma possui alcance negativo.
<span class="lineno">  640 </span> Bool
<span class="lineno">  641 </span><span class="decl"><span class="istickedoff">verifAlcanceTorres torres = and (map (&gt;= 0) alcanceTorres)</span>
<span class="lineno">  642 </span><span class="spaces">    </span><span class="istickedoff">where alcanceTorres = map alcanceTorre torres</span></span>
<span class="lineno">  643 </span>
<span class="lineno">  644 </span>-- | __(3.c)__ A função 'verifRajadaTorres' verifica se todas as torres possuem uma rajada positiva.
<span class="lineno">  645 </span>--
<span class="lineno">  646 </span>-- == Exemplos
<span class="lineno">  647 </span>--
<span class="lineno">  648 </span>-- &gt;&gt;&gt; verifRajadaTorres [Torre (1,1) 1 1 1 1 1 (Projetil Fraqueza Infinita) 1 1]
<span class="lineno">  649 </span>-- True
<span class="lineno">  650 </span>--
<span class="lineno">  651 </span>-- &gt;&gt;&gt; verifRajadaTorres [Torre (1,1) 1 1 0 1 1 (Projetil Fraqueza Infinita) 1 1]
<span class="lineno">  652 </span>-- False
<span class="lineno">  653 </span>--
<span class="lineno">  654 </span>-- &gt;&gt;&gt; verifRajadaTorres [Torre (1,1) 1 1 (-1) 1 1 (Projetil Fraqueza Infinita) 1 1]
<span class="lineno">  655 </span>-- False
<span class="lineno">  656 </span>
<span class="lineno">  657 </span>verifRajadaTorres ::
<span class="lineno">  658 </span> -- | Lista de torres.
<span class="lineno">  659 </span> [Torre] -&gt;
<span class="lineno">  660 </span> -- | Resultado na forma 'True' todas as torres possuem rajada positiva ou 'False' se pelo menos uma possui rajada não positiva.
<span class="lineno">  661 </span> Bool
<span class="lineno">  662 </span><span class="decl"><span class="istickedoff">verifRajadaTorres torres = and (map (&gt; 0) rajadaTorres)</span>
<span class="lineno">  663 </span><span class="spaces">    </span><span class="istickedoff">where rajadaTorres = map rajadaTorre torres</span></span>
<span class="lineno">  664 </span>
<span class="lineno">  665 </span>-- | __(3.d)__ A função 'verifCicloTorres' verifica se todas as torres possuem um ciclo não negativo.
<span class="lineno">  666 </span>--
<span class="lineno">  667 </span>-- == Exemplos
<span class="lineno">  668 </span>--
<span class="lineno">  669 </span>-- &gt;&gt;&gt; verifCicloTorres [Torre (1,1) 1 1 1 1 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  670 </span>-- True
<span class="lineno">  671 </span>--
<span class="lineno">  672 </span>-- &gt;&gt;&gt; verifCicloTorres [Torre (1,1) 1 1 1 0 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  673 </span>-- True
<span class="lineno">  674 </span>--
<span class="lineno">  675 </span>-- &gt;&gt;&gt; verifCicloTorres [Torre (1,1) 1 1 1 (-1) 1 (Projetil Resina Infinita) 1 1]
<span class="lineno">  676 </span>-- False
<span class="lineno">  677 </span>
<span class="lineno">  678 </span>verifCicloTorres ::
<span class="lineno">  679 </span> -- | Lista de torres.
<span class="lineno">  680 </span> [Torre] -&gt;
<span class="lineno">  681 </span> -- | Resultado na forma 'True' se nenhuma torre possui ciclo negativo ou 'False' se pelo menos uma possui ciclo negativo.
<span class="lineno">  682 </span> Bool
<span class="lineno">  683 </span><span class="decl"><span class="istickedoff">verifCicloTorres torres = and (map (&gt;= 0) cicloTorres)</span>
<span class="lineno">  684 </span><span class="spaces">    </span><span class="istickedoff">where cicloTorres = map cicloTorre torres</span></span>
<span class="lineno">  685 </span>
<span class="lineno">  686 </span>-- | __(3.e)__ A função 'verifSobreposTorres' verifica se as torres não estão sobrepostas.
<span class="lineno">  687 </span>--
<span class="lineno">  688 </span>-- == Exemplos
<span class="lineno">  689 </span>--
<span class="lineno">  690 </span>-- &gt;&gt;&gt; verifSobreposTorres [Torre (1,1) 1 1 1 1 1 (Projetil Resina Infinita) 1 1,Torre (2,2) 1 1 1 1 1 (Projetil Fogo Infinita) 1 1]
<span class="lineno">  691 </span>-- True
<span class="lineno">  692 </span>--
<span class="lineno">  693 </span>-- &gt;&gt;&gt; verifSobreposTorres [Torre (1,1) 1 1 1 1 1 (Projetil Resina Infinita) 1 1,Torre (1,1) 1 1 1 1 1 (Projetil Fogo Infinita) 1 1]
<span class="lineno">  694 </span>-- False
<span class="lineno">  695 </span>
<span class="lineno">  696 </span>verifSobreposTorres ::
<span class="lineno">  697 </span> -- | Lista de torres.
<span class="lineno">  698 </span> [Torre] -&gt;
<span class="lineno">  699 </span> -- | Resultado na forma 'True' se não há sobreposição de torres ou 'False' caso contrário.
<span class="lineno">  700 </span> Bool
<span class="lineno">  701 </span><span class="decl"><span class="istickedoff">verifSobreposTorres [] = True</span>
<span class="lineno">  702 </span><span class="spaces"></span><span class="istickedoff">verifSobreposTorres torres</span>
<span class="lineno">  703 </span><span class="spaces">    </span><span class="istickedoff">| pt `elem` pts = False</span>
<span class="lineno">  704 </span><span class="spaces">    </span><span class="istickedoff">| <span class="tickonlytrue">otherwise</span> = verifSobreposTorres (tail torres)</span>
<span class="lineno">  705 </span><span class="spaces">        </span><span class="istickedoff">where (pt:pts) = map posicaoTorre torres</span></span>
<span class="lineno">  706 </span>
<span class="lineno">  707 </span>
<span class="lineno">  708 </span>
<span class="lineno">  709 </span>
<span class="lineno">  710 </span>
<span class="lineno">  711 </span>-- {- Funções relativas à base -} --
<span class="lineno">  712 </span>
<span class="lineno">  713 </span>-- | __(4.a)__ A função 'verifBaseSobreTerra' verifica se a base está posicionada sobre terra.
<span class="lineno">  714 </span>--
<span class="lineno">  715 </span>-- == Exemplos
<span class="lineno">  716 </span>--
<span class="lineno">  717 </span>-- &gt;&gt;&gt; verifBaseSobreTerra (Base 1 (0,0) 1) mapa01
<span class="lineno">  718 </span>-- True
<span class="lineno">  719 </span>--
<span class="lineno">  720 </span>-- &gt;&gt;&gt; verifBaseSobreTerra (Base 1 (2,2) 1) mapa01
<span class="lineno">  721 </span>-- False
<span class="lineno">  722 </span>
<span class="lineno">  723 </span>verifBaseSobreTerra :: 
<span class="lineno">  724 </span> -- | Base do jogo.
<span class="lineno">  725 </span> Base -&gt;
<span class="lineno">  726 </span> -- | Mapa do jogo.
<span class="lineno">  727 </span> Mapa -&gt;
<span class="lineno">  728 </span> -- | Resultado na forma 'True' se a base está posicionada sobre terra ou 'False' caso contrário.
<span class="lineno">  729 </span> Bool
<span class="lineno">  730 </span><span class="decl"><span class="istickedoff">verifBaseSobreTerra base mapa = posicaoBase base `elem` pt</span>
<span class="lineno">  731 </span><span class="spaces">    </span><span class="istickedoff">where pt = filtraPosicoesTerra mapa (<span class="nottickedoff">0</span>,0)</span></span>
<span class="lineno">  732 </span>
<span class="lineno">  733 </span>-- | __(4.b)__ A função 'verifCreditosBase' verifica se os créditos da base não são negativos.
<span class="lineno">  734 </span>--
<span class="lineno">  735 </span>-- == Exemplos
<span class="lineno">  736 </span>--
<span class="lineno">  737 </span>-- &gt;&gt;&gt; verifCreditosBase (Base 1 (0,0) 1)
<span class="lineno">  738 </span>-- True
<span class="lineno">  739 </span>--
<span class="lineno">  740 </span>-- &gt;&gt;&gt; verifCreditosBase (Base 1 (0,0) 0)
<span class="lineno">  741 </span>-- True
<span class="lineno">  742 </span>--
<span class="lineno">  743 </span>-- &gt;&gt;&gt; verifCreditosBase (Base 1 (0,0) (-1))
<span class="lineno">  744 </span>-- False
<span class="lineno">  745 </span>
<span class="lineno">  746 </span>verifCreditosBase :: 
<span class="lineno">  747 </span> -- | Base do jogo.
<span class="lineno">  748 </span> Base -&gt;
<span class="lineno">  749 </span> -- | Resultado na forma 'True' se os créditos da base não são negativos ou 'False' se são negativos.
<span class="lineno">  750 </span> Bool
<span class="lineno">  751 </span><span class="decl"><span class="istickedoff">verifCreditosBase base = creditosBase base &gt;= 0</span></span>
<span class="lineno">  752 </span>
<span class="lineno">  753 </span>-- | __(4.c)__ A função 'verifSobrepoisBaseTorresPortais' verifica se a base não está sobreposta com torres ou com portais.
<span class="lineno">  754 </span>--
<span class="lineno">  755 </span>-- == Exemplos
<span class="lineno">  756 </span>--
<span class="lineno">  757 </span>-- &gt;&gt;&gt; verifSobreposBaseTorresPortais (1,1) [(0,0),(2,2)] [(3,3),(4,4)]
<span class="lineno">  758 </span>-- True
<span class="lineno">  759 </span>--
<span class="lineno">  760 </span>-- &gt;&gt;&gt; verifSobreposBaseTorresPortais (1,1) [(0,0),(1,1)] [(3,3),(4,4)]
<span class="lineno">  761 </span>-- False
<span class="lineno">  762 </span>--
<span class="lineno">  763 </span>-- &gt;&gt;&gt; verifSobreposBaseTorresPortais (1,1) [(0,0),(2,2)] [(1,1),(4,4)]
<span class="lineno">  764 </span>-- False
<span class="lineno">  765 </span>--
<span class="lineno">  766 </span>-- &gt;&gt;&gt; verifSobreposBaseTorresPortais (1,1) [(1,1),(2,2)] [(1,1),(4,4)]
<span class="lineno">  767 </span>-- False
<span class="lineno">  768 </span>
<span class="lineno">  769 </span>verifSobreposBaseTorresPortais :: 
<span class="lineno">  770 </span> -- | Posição da base.
<span class="lineno">  771 </span> Posicao -&gt;
<span class="lineno">  772 </span> -- | Posições das torres.
<span class="lineno">  773 </span> [Posicao] -&gt;
<span class="lineno">  774 </span> -- | Posições dos portais.
<span class="lineno">  775 </span> [Posicao] -&gt;
<span class="lineno">  776 </span> -- | Resultado na forma 'True' caso não haja sobreposições ou 'False' caso contrário.
<span class="lineno">  777 </span> Bool
<span class="lineno">  778 </span><span class="decl"><span class="istickedoff">verifSobreposBaseTorresPortais posBase posTorres posPortais = posBase `notElem` posTorres &amp;&amp; posBase `notElem` posPortais</span></span>

</pre>
</body>
</html>
